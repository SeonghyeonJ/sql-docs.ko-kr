---
title: 키 집합 커서 | Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: MightyPen
ms.author: genemi
ms.openlocfilehash: c7a12d1579af407bca77c9fa61d660a84a09f04e
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/27/2020
ms.locfileid: "67924910"
---
# <a name="keyset-cursors"></a>키 집합 커서
키 집합 커서는 정적 커서와 동적 커서 사이의 기능을 제공 하 여 변경 내용을 검색할 수 있습니다. 정적 커서처럼 항상 결과 집합의 멤버 자격과 순서에 대한 변경 내용을 검색하지는 못합니다. 동적 커서처럼 결과 집합의 행 값에 대한 변경 내용을 검색합니다.  
  
 키 집합 커서는 키 집합이라는 고유 식별자(키) 집합으로 제어됩니다. 키는 결과 집합에서 행을 고유하게 식별하는 열 집합으로 작성됩니다. 키 집합은 쿼리 문에서 반환된 모든 행의 키 값 집합입니다.  
  
 키 집합 커서를 사용하여 커서의 각 행에 대해 키를 빌드 및 저장하고 클라이언트 워크스테이션 또는 서버에 저장합니다. 각 행에 액세스하면 저장된 키를 사용하여 데이터 원본에서 현재 데이터 값을 페치합니다. 키 집합 커서에서 키 집합이 완전히 채워지면 결과 집합 멤버 자격이 고정됩니다. 이후 멤버 자격에 영향을 주는 추가 또는 업데이트는 다시 열 때까지 결과 집합의 일부가 아닙니다.  
  
 사용자가 결과 집합을 스크롤하면 데이터 값의 변경 내용이 표시 됩니다 (키 집합 소유자 또는 다른 프로세스에 의해 결정 됨). 커서 외부에서 수행한 삽입은(다른 프로세스에 의해)은 커서를 닫았다가 다시 열 때만 볼 수 있습니다. 커서 내에서 수행한 삽입은 결과 집합의 끝에 표시됩니다.  
  
 키 집합 커서에서 삭제 된 행을 검색 하려고 하면 행이 결과 집합에 "구멍"으로 표시 됩니다. 행의 키는 키 집합에 있지만 행은 결과 집합에 더 이상 존재하지 않습니다. 행의 키 값이 업데이트 되는 경우 행이 삭제 된 후 삽입 된 것으로 간주 되므로 이러한 행도 결과 집합에 구멍으로 표시 됩니다. 키 집합 커서는 다른 프로세스에서 삭제 된 행을 항상 검색할 수 있지만, 삭제 하는 행의 키를 선택적으로 제거할 수 있습니다. 이 작업을 수행 하는 키 집합 커서는 증명 정보가 제거 되었으므로 자체 삭제를 검색할 수 없습니다.  
  
 키 열에 대 한 업데이트는 이전 키를 삭제 한 다음 새 키를 삽입 하는 것 처럼 작동 합니다. 커서를 통해 업데이트가 이루어지지 않은 경우 새 키 값이 표시 되지 않습니다. 커서를 통해 업데이트 한 경우 새 키 값은 결과 집합의 끝에 표시 됩니다.  
  
 키 집합 기반 표준 커서 라는 키 집합 커서에 대 한 변형이 있습니다. 키 집합 기반 표준 커서의 경우 결과 집합에 있는 행의 멤버 자격과 행의 순서는 커서 열기 시간에 고정 되지만 커서 소유자가 수행한 값 및 다른 프로세스의 커밋된 변경 내용에 대 한 변경 내용이 표시 됩니다. 멤버가 멤버 자격에 대 한 행을 한 정하는 경우 또는 행의 순서에 영향을 주는 경우에는 커서를 닫았다가 다시 열지 않는 한 행이 사라지고 이동 하지 않습니다. 삽입 된 데이터는 나타나지 않지만 기존 데이터의 변경 내용은 행이 인출 될 때 표시 됩니다.  
  
 데이터 변경에 대 한 민감도는 위에 설명 된 대로 서로 다른 여러 상황에 따라 달라 지므로 키 집합 커서는 올바르게 사용 하기 어렵습니다. 그러나 응용 프로그램에서 동시 업데이트를 수행 하지 않아도 되는 경우에서 잘못 된 키를 프로그래밍 방식으로 처리 하 고 특정 키 행에 직접 액세스 해야 하는 경우 키 집합 커서를 사용할 수 있습니다. **Adopenkeyset 집합 CursorTypeEnum** 를 사용 하 여 ADO에서 키 집합 커서를 사용 하도록 지정 합니다.  
  
## <a name="see-also"></a>참고 항목  
 [앞 으로만 이동 가능한 커서](../../../ado/guide/data/forward-only-cursors.md)   
 [정적 커서](../../../ado/guide/data/static-cursors.md)   
 [동적 커서](../../../ado/guide/data/dynamic-cursors.md)
