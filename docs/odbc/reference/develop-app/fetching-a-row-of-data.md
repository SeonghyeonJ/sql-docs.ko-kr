---
title: 데이터 행 가져오기 | 마이크로 소프트 문서
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLFetch function [ODBC], fetching a row of data
- cursors [ODBC], fetching rows
- result sets [ODBC], fetching
- fetches [ODBC], row of data
ms.assetid: 16d4a380-0d83-456b-aeee-f10738944e86
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a702f561b756d5305020df9f015d3ea4b444caa6
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305674"
---
# <a name="fetching-a-row-of-data"></a>데이터 행 페치
데이터 행을 가져오려면 응용 프로그램에서 **SQLFetch**를 호출합니다. **SQLFetch는** 모든 종류의 커서와 함께 호출할 수 있지만 행 집합 커서만 정방향 전용 방향으로 이동합니다. **SQLFetch는** 커서를 다음 행으로 이동시키고 **SQLBindCol**에 대한 호출로 바인딩된 모든 열에 대한 데이터를 반환합니다. 커서가 결과 집합의 끝에 도달하면 **SQLFetch는** SQL_NO_DATA 반환합니다. **SQLFetch**호출의 예는 [SQLBindCol 을 사용하여](../../../odbc/reference/develop-app/using-sqlbindcol.md)를 참조하십시오.  
  
 **SQLFetch가** 구현되는 정확한 방법은 드라이버에 따라 다르지만 일반적인 패턴은 드라이버가 데이터 원본에서 바인딩된 열에 대한 데이터를 검색하고 바인딩된 변수의 형식에 따라 변환한 다음 변환된 데이터를 해당 변수에 배치하는 것입니다. 드라이버가 데이터를 변환할 수 없는 경우 **SQLFetch는** 오류를 반환합니다. 응용 프로그램은 행을 계속 가져올 수 있지만 현재 행의 데이터는 손실됩니다. 언바운드 열에 대한 데이터에 대한 작업은 드라이버에 따라 다르지만 대부분의 드라이버는 검색및 삭제하거나 전혀 검색하지 않습니다.  
  
 또한 드라이버는 바인딩된 모든 길이/표시기 버퍼의 값을 설정합니다. 열의 데이터 값이 NULL이면 드라이버는 해당 길이/표시기 버퍼를 SQL_NULL_DATA 설정합니다. 데이터 값이 NULL이 아닌 경우 드라이버는 변환 후 데이터의 바이트 길이로 길이/표시기 버퍼를 설정합니다. 이 길이를 결정할 수 없는 경우, 때로는 두 개 이상의 함수 호출에 의해 검색되는 긴 데이터가 있는 경우처럼, 드라이버는 길이/표시기 버퍼를 SQL_NO_TOTAL 위해 설정합니다. 정수 및 날짜 구조와 같은 고정 길이 데이터 형식의 경우 바이트 길이는 데이터 형식의 크기입니다.  
  
 문자 및 이진 데이터와 같은 가변 길이 데이터의 경우 드라이버는 변환된 데이터의 바이트 길이를 열에 바인딩된 버퍼의 바이트 길이에 대해 확인합니다. 버퍼의 길이는 **SQLBindCol**의 *BufferLength* 인수에 지정됩니다. 변환된 데이터의 바이트 길이가 버퍼의 바이트 길이보다 큰 경우 드라이버는 버퍼에 맞게 데이터를 잘리고 길이/표시기 버퍼에서 잘린 길이를 반환하고 SQL_SUCCESS_WITH_INFO 반환하며 SQLSTATE 01004(데이터 잘린 데이터)를 진단 에 배치합니다. 유일한 예외는 SQLSTATE 22001 (문자열 데이터, 오른쪽 잘린)을 반환 하는 **SQLFetch에서**반환 할 때 가변 길이 책갈피 잘린 경우입니다.  
  
 드라이버는 바인딩된 버퍼의 크기가 데이터 형식의 크기라고 가정하기 때문에 고정 길이 데이터는 잘린 적이 없습니다. 응용 프로그램은 일반적으로 전체 데이터 값을 보유할 수 있을 만큼 큰 버퍼를 바인딩하기 때문에 데이터 잘림은 드문 경향이 있습니다. 메타데이터에서 필요한 크기를 결정합니다. 그러나 응용 프로그램은 너무 작음으로 알고 있는 버퍼를 명시적으로 바인딩할 수 있습니다. 예를 들어 부품 설명의 처음 20자 또는 긴 텍스트 열의 처음 100자(문자)를 검색하고 표시할 수 있습니다.  
  
 문자 데이터는 잘린 경우에도 응용 프로그램에 반환되기 전에 드라이버에 의해 null-종료되어야 합니다. null-termination 문자는 반환된 바이트 길이에 포함되지 않지만 바인딩된 버퍼에 공간이 필요합니다. 예를 들어 응용 프로그램이 ASCII 문자 집합의 문자 데이터로 구성된 문자열을 사용하고 드라이버에 반환할 데이터 문자가 50개이고 응용 프로그램의 버퍼길이가 25바이트라고 가정합니다. 응용 프로그램의 버퍼에서 드라이버는 null 종료 문자 다음에 처음 24개의 문자를 반환합니다. 길이/표시기 버퍼에서 바이트 길이50을 반환합니다.  
  
 응용 프로그램은 결과 집합을 만드는 문을 실행하기 전에 SQL_ATTR_MAX_ROWS 문 특성을 설정하여 결과 집합의 행 수를 제한할 수 있습니다. 예를 들어 보고서 서식을 지정하는 데 사용되는 응용 프로그램의 미리 보기 모드에는 보고서의 첫 페이지를 표시하기에 충분한 데이터만 있으면 됩니다. 결과 집합의 크기를 제한하면 이러한 기능이 더 빠르게 실행됩니다. 이 명령문 특성은 네트워크 트래픽을 줄이기 위한 것이며 모든 드라이버에서 지원되지 않을 수 있습니다.
