---
title: SQL Server R Services 성능 조정
ms.prod: sql
ms.technology: machine-learning
ms.date: 04/15/2018
ms.topic: conceptual
author: dphansen
ms.author: davidph
ms.openlocfilehash: 49b96bf2c3381f3b0d44ba0b0192fbe0c0df4a2f
ms.sourcegitcommit: c1382268152585aa77688162d2286798fd8a06bb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/19/2019
ms.locfileid: "68344860"
---
# <a name="performance-tuning-for-r-in-sql-server"></a>SQL Server에서 R에 대 한 성능 조정
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

이 문서는 두 가지 사례 연구를 기반으로 R 서비스에 대 한 성능 최적화를 설명 하는 4 개의 문서 시리즈 중 첫 번째입니다.

- R 솔루션의 성능 프로필 유효성을 검사 하기 위해 제품 개발 팀에서 수행 하는 성능 테스트

- 고객이 자주 요청 하는 특정 기계 학습 시나리오에 대 한 Microsoft 데이터 과학 팀의 성능 최적화

이 시리즈의 목표는 SQL Server에서 R 작업을 실행 하는 데 가장 유용한 성능 튜닝 기술 유형에 대 한 지침을 제공 하는 것입니다.

+ 이 (첫 번째) 항목에서는 아키텍처에 대 한 개요와 데이터 과학 작업을 최적화할 때 발생 하는 몇 가지 일반적인 문제에 대해 설명 합니다.
+ 두 번째 문서에서는 특정 하드웨어 및 SQL Server 최적화에 대해 설명 합니다.
+ 세 번째 문서에서는 운영 화에 대 한 R 코드 및 리소스의 최적화에 대해 다룹니다.
+ 네 번째 문서에서는 테스트 메서드에 대해 자세히 설명 하 고 결과 및 결론을 보고 합니다.

**적용 대상:** SQL Server 2016 R Services, SQL Server 2017 Machine Learning Services

## <a name="performance-goals-and-targeted-scenarios"></a>성능 목표 및 대상 시나리오

R Services 기능은 SQL Server에서 R 스크립트 실행을 지원 하기 위해 SQL Server 2016에서 도입 되었습니다. 이 기능을 사용 하는 경우 R 런타임은 데이터베이스 엔진과는 별도의 프로세스에서 작동 하지만 신뢰할 수 있는 실행 패드와 같은 SQL Server와 상호 작용 하는 서비스를 사용 하 여 데이터베이스 엔진과 데이터를 안전 하 게 교환 합니다.

SQL Server 2017에서는 나중에 추가 언어를 사용 하 여 동일한 아키텍처를 사용 하는 Python 스크립트 실행에 대 한 지원이 발표 되었습니다.

지원 되는 버전 및 언어의 수가 증가 함에 따라, 데이터베이스 관리자와 데이터베이스의 설계자는 machine learning 작업으로 인 한 리소스 경합 가능성을 인식 하 고 서버를 지원 하도록 구성 하는 것이 중요 합니다. 새 작업입니다. 분석을 데이터와 가깝게 유지 해도 안전 하지 않은 데이터 이동이 제거 되지만, 분석 워크 로드를 데이터 과학자 노트북에서 이동 하 고 데이터를 호스팅하는 서버로 다시 이동 하기도 합니다.

기계 학습에 대 한 성능 최적화는 완전히 단일 크기의 제안을 아닙니다. 다음과 같은 일반 작업에는 성능 프로필이 매우 다를 수 있습니다.

- 학습 작업: 회귀 모델 만들기 및 교육 및 신경망 학습
- T-sql을 사용 하 여 R과 기능 추출을 사용 하 여 기능 엔지니어링
- 테이블 형식 입력을 사용 하 여 단일 행 또는 작은 일괄 처리에 대 한 점수 매기기 및 대량 점수 매기기
- R의 점수 매기기 실행 및 저장 프로시저의 SQL Server에 대 한 프로덕션에 모델 배포
- 데이터 전송을 최소화 하거나 비용이 많이 드는 데이터 변환을 제거 하기 위해 R 코드 수정
- 모델 자동 테스트 및 재 학습 사용

최적화 기술 선택은 응용 프로그램 또는 사용 사례에 중요 한 작업에 따라 달라 지므로 사례 연구에서는 일반적인 성능 팁과 특정 시나리오를 최적화 하는 방법에 대 한 지침, 일괄 처리 점수 매기기에 대 한 지침을 제공 합니다.

+ **SQL Server의 개별 최적화 옵션**

    첫 번째 성능 사례 연구에서 단일 모델 유형을 사용 하 여 단일 데이터 집합에 대해 여러 테스트를 실행 했습니다. RevoscaleR의 rxLinMod 알고리즘은 모델을 작성 하 고 점수를 생성 하는 데 사용 되었습니다. 하지만 각 변경 내용의 영향을 테스트 하기 위해 기본 데이터 테이블 및 코드는 체계적으로 변경 되었습니다.

    예를 들어 하나의 테스트 실행에서 변환 함수를 사용 하 여 기능 엔지니어링과 기능을 미리 계산한 다음 테이블에서 기능을 로드 하 여 비교를 수행할 수 있도록 R 코드를 변경 했습니다. 다른 테스트 실행에서는 다양 한 유형의 압축 또는 새 인덱스 유형을 사용 하 여 테이블에서 표준 인덱싱된 테이블과 데이터를 사용 하는 것 사이에 모델 학습 성능을 비교 했습니다.

+ **특정 대량 점수 매기기 시나리오에 대 한 최적화**

    두 번째 사례 연구의 기계 학습 작업에는 여러 위치에 대해 제출 된 많은 이력서를 처리 하 고 각 작업 위치에 대해 가장 적합 한 후보를 찾는 과정이 포함 됩니다. 기계 학습 모델 자체는 이진 분류 문제로 공식화 됩니다. 즉, 다시 시작 및 작업 설명을 입력으로 사용 하 고 각 다시 시작 작업 쌍에 대 한 확률을 생성 합니다. 가장 일치 하는 항목을 찾는 것이 목표 이기 때문에 사용자 정의 확률 임계값은 적절 한 일치 항목만 필터링 하 고 가져오는 데 사용 됩니다.

    이 솔루션의 경우 주요 목표는 점수 매기기 중에 짧은 대기 시간을 달성 하는 것 이었습니다. 그러나이 작업은 점수 매기기 프로세스가 진행 되는 동안에도 계산 비용이 많이 듭니다. 각 새 작업은 적절 한 시간 프레임 내에 수백만 개의 이력서와 일치 해야 하기 때문입니다. 또한 기능 엔지니어링 단계는 다시 시작 또는 작업당 2000 개 이상의 기능을 생성 하며 심각한 성능 병목 상태입니다.

첫 번째 사례 연구의 모든 결과를 검토 하 여 솔루션에 적용할 수 있는 기술을 결정 하 고 잠재적인 영향을 평가 하는 것이 좋습니다.

그런 다음 점수 매기기 최적화 사례 연구의 결과를 검토 하 여 작성자가 다양 한 기술을 적용 하 고 특정 작업을 지원 하도록 서버를 최적화 하는 방법을 확인 합니다.

## <a name="performance-optimization-process"></a>성능 최적화 프로세스

성능에 대 한 구성 및 튜닝에는 특정 워크 로드에 맞게 설계 된 레이어 최적화를 위한 solid 베이스를 만들어야 합니다.

- Analytics를 호스트할 적절 한 서버를 선택 합니다. 일반적으로 다른 보고 또는 분석에 이미 사용 되는 보고 보조, 데이터 웨어하우스 또는 다른 서버를 사용 하는 것이 좋습니다. 그러나 하이브리드 트랜잭션 분석 처리 (HTAP) 솔루션에서는 빠른 점수 매기기를 위해 운영 데이터를 R에 대 한 입력으로 사용할 수 있습니다.

- 적절 한 수준에서 데이터베이스 엔진 작업과 R 또는 Python 스크립트 실행의 균형을 유지 하도록 SQL Server 인스턴스를 구성 합니다. 여기에는 메모리 및 CPU 사용량에 대 한 기본값 SQL Server 변경, NUMA 및 프로세서 선호도 설정 및 리소스 그룹 생성이 포함 될 수 있습니다.

- 서버 컴퓨터를 최적화 하 여 외부 스크립트를 효율적으로 사용할 수 있도록 지원 합니다. 여기에는 외부 스크립트 실행에 사용 되는 계정 수가 늘어나고, 패키지 관리를 사용 하도록 설정 하 고, 관련 보안 역할에 사용자를 할당할 수 있습니다.

- 인덱싱 및 통계 전략, 쿼리 디자인 및 쿼리 최적화, 기계 학습에 사용 되는 테이블 디자인 등의 데이터 저장 및 SQL Server 전송에 대 한 최적화를 적용 합니다. 데이터 원본 및 데이터 전송 메서드를 분석 하거나 기능 추출을 최적화 하기 위해 ETL 프로세스를 수정할 수도 있습니다.

- 비효율성을 방지 하기 위해 분석 모델을 조정 합니다. 가능한 최적화 범위는 R 코드의 복잡성과 사용 중인 패키지 및 데이터에 따라 달라 집니다. 중요 한 작업에는 비용이 많이 드는 데이터 변환 제거 또는 R 또는 Python에서 ETL 프로세스나 SQL로의 데이터 준비 또는 기능 엔지니어링 작업을 오프 로드 하는 작업이 포함 됩니다. 또한 스크립트를 리팩터링 하 고, 인라인 패키지 설치를 제거 하 고, 학습, 점수 매기기 및 평가를 위한 별도의 프로시저로 R 코드를 나눌 수 있으며, 코드를 간소화 하 여 저장 프로시저로 보다 효율적으로 작업할 수 있습니다.

## <a name="articles-in-this-series"></a>이 시리즈의 문서

+ [SQL Server에서 R에 대 한 성능 조정-하드웨어](../r/sql-server-configuration-r-services.md)

    에 설치 된 하드웨어 [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] 를 구성 하 고 외부 스크립트를 더 잘 지원 하도록 SQL Server 인스턴스를 구성 하기 위한 지침을 제공 합니다. **데이터베이스 관리자**에 게 특히 유용 합니다.

+ [SQL Server에서 R에 대 한 성능 조정-코드 및 데이터 최적화](../r/r-and-data-optimization-r-services.md)

    알려진 문제를 방지 하기 위해 외부 스크립트를 최적화 하는 방법에 대 한 특정 팁을 제공 합니다. **데이터 과학자**에 가장 유용 합니다.

    > [!NOTE]
    > 이 섹션의 많은 정보는 일반적으로 R에 적용 되지만 일부 정보는 RevoScaleR 분석 함수에만 적용 됩니다. **Revoscalepy** 및 기타 지원 되는 Python 라이브러리에 대해서는 자세한 성능 지침을 사용할 수 없습니다.
    >

+ [SQL Server에서 R에 대 한 성능 조정-메서드 및 결과](../r/performance-case-study-r-services.md)

    두 사례 연구에 사용 된 데이터, 성능 테스트 방법 및 최적화의 영향을 받는 방법에 대해 간략하게 설명 합니다.
