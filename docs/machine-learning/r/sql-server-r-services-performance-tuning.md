---
title: R 성능 튜닝
description: 이 문서에서는 R Services의 성능 최적화에 대해 설명합니다.
ms.prod: sql
ms.technology: machine-learning-services
ms.date: 04/15/2018
ms.topic: how-to
author: dphansen
ms.author: davidph
ms.custom: seo-lt-2019
monikerRange: '>=sql-server-2016||>=sql-server-linux-ver15||=sqlallproducts-allversions'
ms.openlocfilehash: cedb8cd13db6c8d27b987c60881093caa91af50a
ms.sourcegitcommit: 9b41725d6db9957dd7928a3620fe4db41eb51c6e
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/13/2020
ms.locfileid: "88180463"
---
# <a name="performance-tuning-for-r-in-sql-server"></a>SQL Server의 R 성능 튜닝
[!INCLUDE [SQL Server 2016 and later](../../includes/applies-to-version/sqlserver2016.md)]

이 문서는 다음 두 가지 사례 연구를 바탕으로 R Services 성능 최적화를 설명하는 4가지 문서 시리즈의 첫 번째 문서입니다.

- 제품 개발 팀에서 R 솔루션의 성능 프로필 유효성 검사를 위해 성능 테스트 수행

- Microsoft 데이터 과학 팀에서 고객이 자주 요청하는 특정 기계 학습 시나리오에 맞게 성능 최적화

이 시리즈의 목표는 SQL Server에서 R 작업을 실행하는 데 가장 유용한 성능 튜닝 기술의 유형을 소개하는 것입니다.

+ 이 첫 번째 토픽에서는 아키텍처의 개요와 데이터 과학 작업에 맞게 최적화할 때 발생하는 몇 가지 일반적인 문제에 대해 설명 합니다.
+ 두 번째 문서에서는 특정 하드웨어 및 SQL Server 최적화를 다룹니다.
+ 세 번째 문서에서는 연산화를 위한 R 코드 및 리소스의 최적화를 다룹니다.
+ 네 번째 문서에서는 테스트 메서드에 대해 자세히 설명하고 결과와 결론을 전합니다.

**적용 대상:** SQL Server 2016 R Services, SQL Server Machine Learning Services

## <a name="performance-goals-and-targeted-scenarios"></a>성능 목표 및 대상 시나리오

R Services 기능은 SQL Server의 R 스크립트 실행을 지원하기 위해 SQL Server 2016에서 도입되었습니다. 이 기능을 사용하면 R 런타임이 데이터베이스 엔진과 별개의 프로세스에서 작동하지만, 신뢰할 수 있는 실행 패드와 같이 SQL Server와 상호 작용하는 서버 리소스 및 서비스를 사용하여 데이터베이스 엔진과 안전하게 데이터를 교환합니다.

SQL Server 2017에서 동일한 아키텍처를 사용하는 Python 스크립트 실행 지원이 발표되었으며 이후에 언어 지원도 추가되었습니다.

지원되는 버전과 언어가 늘어남에 따라 데이터베이스 관리자와 데이터베이스 설계자는 기계 학습 작업으로 인한 리소스 경합 가능성을 인식하고 새 워크로드를 지원하도록 서버를 구성할 수 있어야 합니다. 분석을 데이터에 가까이 두면 안전하지 않은 데이터 이동이 없지만 데이터 과학자의 랩톱에서 데이터를 호스팅하는 서버로 분석 워크로드가 이동합니다.

기계 학습 성능 최적화가 모든 상황에 맞는 것은 아닙니다. 다음과 같은 일반 작업은 성능 프로필이 매우 다를 수 있습니다.

- 학습 작업: 회귀 모델 작성 및 학습과 신경망 학습
- R을 사용하는 기능 엔지니어링과 T-SQL을 사용하는 기능 추출
- 단일 행 또는 작은 배치로 채점과 테이블 형식 입력을 사용한 일괄 채점
- R에서 채점 실행과 저장 프로시저로 SQL Server의 프로덕션에 모델 배포
- R 코드를 수정하여 데이터 전송 최소화 또는 비용이 많이 드는 데이터 변환 제거
- 자동화된 모델 테스트 또는 재학습 사용

최적화 기술 선택은 애플리케이션이나 사용 사례에 중요한 작업에 따라 달라지므로 사례 연구에서는 일반적인 성능 팁을 모두 다루고 일괄 채점을 위한 최적화인 특정 시나리오에 맞게 최적화하는 방법을 안내합니다.

+ **SQL Server의 개별 최적화 옵션**

    첫 번째 성능 사례 연구에서 단일 모델 유형을 사용하여 단일 데이터 세트에 대해 여러 테스트를 실행했습니다. 모델을 빌드하고 그로부터 점수를 생성하는 데 RevoscaleR의 rxLinMod 알고리즘이 사용되었지만 각 변경 내용의 영향을 테스트하기 위해 기본 데이터 테이블과 코드가 체계적으로 변경되었습니다.

    예를 들어, 한 테스트 실행에서는 변환 함수를 사용하여 기능 엔지니어링을 수행하는 것과 기능을 미리 계산한 후 테이블에서 기능을 로드 하는 것을 비교할 수 있게 R 코드가 변경되었습니다. 또 다른 테스트 실행에서는 인덱싱된 표준 테이블을 사용하는 경우와 다양한 압축 유형이나 새로운 인덱스 유형의 테이블 데이터를 사용하는 경우의 모델 학습 성능을 비교했습니다.

+ **특정 대량 채점 시나리오에 맞게 최적화**

    두 번째 사례 연구의 기계 학습 작업에는 여러 직책에 대해 제출된 많은 이력서를 처리하고 각 직위에 가장 적합한 후보를 찾는 과정이 포함됩니다. 기계 학습 모델 자체는 이진 분류 문제로 공식화됩니다. 즉, 이력서와 직업 설명을 입력으로 사용하고 각 이력서-직업 쌍의 가능성을 생성합니다. 목표는 최고의 적임자를 찾는 것이기 때문에 추가로 필터링하고 잘 맞는 후보를 찾기 위해 사용자가 정의하는 가능성 임계값이 사용됩니다.

    이 솔루션의 주요 목표는 채점 중 대기 시간을 줄이는 것이었습니다. 그러나 이 작업은 채점 프로세스가 진행되는 동안에도 계산 비용이 많이 듭니다. 적절한 시간 프레임 내에 수백만 개의 이력서와 각각의 새 일자리를 비교해야 하기 때문입니다. 또한 기능 엔지니어링 단계에서 이력서나 일자리당 2000개가 넘는 기능을 생성하여 심각한 성능 병목 현상을 일으킵니다.

첫 번째 사례 연구의 모든 결과를 검토하여 솔루션에 적용할 수 있는 기술을 결정하고 잠재적인 영향을 평가하는 것이 좋습니다.

그런 다음, 채점 최적화 사례 연구의 결과를 검토하여 작성자가 다양한 기술을 적용하고 특정 워크로드를 지원하도록 서버를 최적화한 방법을 확인합니다.

## <a name="performance-optimization-process"></a>성능 최적화 프로세스

성능 구성 및 튜닝을 수행하려면 다음과 같이 특정 워크로드에 맞게 설계된 최적화를 준비해야 합니다.

- 분석을 호스트할 적절한 서버를 선택합니다. 일반적으로 다른 보고 또는 분석에 이미 사용되는 보고 보조, 데이터 웨어하우스 또는 다른 서버를 사용하는 것이 좋습니다. 그러나 HTAP(하이브리드 트랜잭션 분석 처리) 솔루션에서는 빠른 채점을 위해 작동 데이터를 R에 대한 입력으로 사용할 수 있습니다.

- 적절한 수준에서 데이터베이스 엔진 작업과 R 또는 Python 스크립트 실행의 균형을 유지하도록 SQL Server 인스턴스를 구성합니다. 여기에는 메모리 및 CPU 사용량에 대한 SQL Server 기본값 변경, NUMA 및 프로세서 선호도 설정 및 리소스 그룹 생성이 포함 될 수 있습니다.

- 외부 스크립트의 효율적인 사용을 지원하도록 서버 컴퓨터를 최적화합니다. 여기에는 외부 스크립트 실행에 사용되는 계정 수 증가, 패키지 관리 사용, 관련 보안 역할에 사용자 할당이 포함될 수 있습니다.

- SQL Server에서 데이터 저장과 전송에 특정한 최적화를 적용합니다. 여기에는 인덱싱 및 통계 전략, 쿼리 디자인 및 최적화, 기계 학습에 사용되는 테이블 디자인이 포함됩니다. 데이터 원본 및 데이터 전송 메서드를 분석하거나 기능 추출 최적화를 위해 ETL 프로세스를 수정할 수도 있습니다.

- 효율성이 떨어지지 않게 분석 모델을 조정합니다. 가능한 최적화 범위는 R 코드의 복잡성과 사용 중인 패키지 및 데이터에 따라 달라집니다. 주요 작업에는 비용이 많이 드는 데이터 변환 제거나 R 또는 Python에서 ETL 프로세스 또는 SQL로 데이터 준비나 기능 엔지니어링 작업 오프로드가 포함됩니다. 스크립트를 리팩터링하거나, 인라인 패키지 설치를 제거하거나, 학습, 채점 및 평가를 위한 별도의 프로시저로 R 코드를 나누거나, 저장 프로시저로 보다 효율적으로 작동하도록 코드를 간소화할 수도 있습니다.

## <a name="articles-in-this-series"></a>이 시리즈의 문서

+ [SQL Server의 R 성능 튜닝 - 하드웨어](../r/sql-server-configuration-r-services.md)

    [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]가 설치되는 하드웨어를 구성하는 지침과 외부 스크립트를 보다 잘 지원하도록 SQL Server 인스턴스를 구성하는 지침을 제공합니다. **데이터베이스 관리자**에게 특히 유용합니다.

+ [SQL Server의 R 성능 튜닝 - 코드 및 데이터 최적화](../r/r-and-data-optimization-r-services.md)

    알려진 문제를 피하기 위해 외부 스크립트를 최적화하는 방법에 대한 구체적인 팁을 제공합니다. **데이터 과학자**에게 가장 유용합니다.

    > [!NOTE]
    > 이 섹션의 많은 정보는 일반적으로 R에 적용되지만 일부 정보는 RevoScaleR 분석 함수와 관련이 있습니다. **revoscalepy**와 기타 지원되는 Python 라이브러리에 대한 자세한 성능 지침은 제공되지 않습니다.
    >

+ [SQL Server의 R 성능 튜닝 - 방법 및 결과](../r/performance-case-study-r-services.md)

    두 사례 연구에 어느 데이터가 사용되었는지, 성능이 어떻게 테스트되었는지, 최적화가 결과에 어떤 영향을 주었는지 간략하게 설명합니다.
